---
title: " select"
author:
- familyname: Shi
  othernames: Jingyi
  address: Monash University
  email: jshi0067@student.monash.edu
  correspondingauthor: true
  qualifications:  32267886
- familyname: Sun
  othernames: Miao
  address: Monash University
  email: msun0008@student.monash.edu
  correspondingauthor: true
  qualifications: 28380584
- familyname: Ou
  othernames: Jingwen
  address: Monash University
  email: jouu0006@student.monash.edu
  correspondingauthor: true
  qualifications:  32269633
- familyname: Qin
  othernames: Yu
  address: Monash University
  email: yqin0016@student.monash.edu
  correspondingauthor: true
  qualifications:  32606745
department: Faculty of Business and Statistic
organization: Monash University ETC5513 Group Really3Q
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    citation_package: biblatex
    toc: false
---

```{r}
library(tidyverse)
library(ggplot2)
library(readr)
library(knitr)
library(plotly)
library(gridExtra)
```

## Introduction

## Main body

### Mexico and Germany

```{r  results='hide'}
annual_number_of_deaths_by_cause <- read_csv("Data/annual-number-of-deaths-by-cause.csv", 
    col_types = cols(`Number of executions` = col_double())) 

```

```{r Mexico}
Mexico <- annual_number_of_deaths_by_cause %>%
  filter(Country == "Mexico") %>%
  filter(!is.na(Code), Year >= 2005) %>%
  pivot_longer(cols = c(4:36), 
               names_to = "Death_cause", 
               values_to = "Count") %>% 
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
  arrange(desc(Death_amount))
Mexico %>%
head(n=5) %>%
kable(caption = "Deaths by cause of Mexico")
  
```

```{r Germany}
Germany <- annual_number_of_deaths_by_cause %>%
  filter(Country == "Germany") %>%
  filter(!is.na(Code), Year >= 2005) %>%
  pivot_longer(cols = c(4:36), 
               names_to = "Death_cause", 
               values_to = "Count") %>% 
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
  arrange(desc(Death_amount))
Germany %>%
head(n=5) %>%
kable(caption = "Deaths by cause of Germany")
```

```{r MexicoAndGermanyfigure,fig.cap = "Deaths by cause in Mexico and Germany"}
Mexico_cause <- annual_number_of_deaths_by_cause %>% 
    select(-2, -4) %>% 
  filter(Country == "Mexico",
         Year >= 2005) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count") 
Mexico_plot <- Mexico_cause %>%
  filter(Death_cause %in% c("Cardiovascular diseases", 
                            "Neoplasms",
                            "Chronic kidney disease",
                            "Digestive diseases",
                            "Diabetes mellitus")) %>%
  ggplot(mapping = aes(x = Year)) +
  geom_line(aes(y = Count,
  color = Death_cause)) +
  ggtitle("Mexico death cause trend")

Germany_cause <- annual_number_of_deaths_by_cause %>% 
    select(-2, -4) %>% 
  filter(Country == "Germany",
         Year >= 2005) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count") 
Germany_plot <- Germany_cause %>%
  filter(Death_cause %in% c("Cardiovascular diseases", 
                            "Neoplasms",
                            "Digestive diseases",
                            "Alzheimer's disease and other dementias",
                            "Chronic respiratory diseases")) %>%
  ggplot(mapping = aes(x = Year)) +
  geom_line(aes(y = Count,
  color = Death_cause)) +
  ggtitle("Germany death cause trend")
gridExtra::grid.arrange(Mexico_plot,Germany_plot, nrow = 2)
```

