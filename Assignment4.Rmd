---
title: 'Title'
author: ""
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  prettydoc::html_pretty:
    theme: HPSTR
    highlight: github
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r}
library(readr)
library(tidyverse)
library(knitr)
annual_number_of_deaths_by_cause <- read_csv("Data/annual-number-of-deaths-by-cause.csv", 
    col_types = cols(`Number of executions` = col_double()))
GDP <- read_csv("Data/GDP.csv")
```

```{r}
df_global <-  annual_number_of_deaths_by_cause %>%
  filter(Year %in% c(1950:2018)) %>% 
  pivot_longer(
    cols =  -c(Country, Code, Year),
    names_to = "Death_cause",
    values_to = "Count"
  )

df_CI <- df_global %>%  
  filter(Country %in% c("China", "India"))

interest <- c(
  "Cardiovascular diseases",
  "Diabetes mellitus",
  "HIV/AIDS",
  "Neoplasms",
  "Nutritional deficiencies",
  "Malaria"
)
```

```{r global Death due to different cause}

interest_global <- df_global %>% 
  group_by(Year, Death_cause) %>% 
  mutate(Death_global = sum(Count, na.rm = TRUE)) %>%
  filter(Death_cause %in% interest) %>% 
  group_by(Year,
           Death_cause,
           Death_global) %>% 
  summarise()

interest_global %>% 
  ggplot(aes(x = Year,
             y = Death_global,
             color = Death_cause))+
  geom_line()
```



```{r}
CI_Percent <- df_CI%>% 
  group_by(Country,
           Year) %>% 
  mutate(Total_death = sum(Count, na.rm = TRUE)*100
         ) %>% 
  group_by(Country,
           Year,
           Death_cause,
           Total_death) %>% 
  summarize(Percentage = Count/Total_death*100) %>% 
  group_by(Country,
           Death_cause) %>% 
  arrange(desc(Percentage)) %>% 
  filter(Death_cause %in% interest)

CI_Total <- df_CI %>% 
  group_by(Country,
           Year, 
           Death_cause) %>% 
  mutate(Death_abs = sum(Count, na.rm = TRUE)) %>%
  filter(Death_cause %in% interest) %>% 
  group_by(Year,
           Country,
           Death_cause,
           Death_abs) %>% 
  summarise() %>% 
  left_join(GDP)
```

```{r Percentage Change in China and India}
Percentage_trend <- CI_Percent %>% 
  ggplot(aes(x = Year,
             y = Percentage,
             color = Death_cause))+
  geom_line() +
  facet_wrap(~Country, nrow = 2, scales = "free_y")

Absolute_trend <- CI_Total %>% 
  ggplot(aes(x = Year))+
  geom_line(aes(y = Death_abs,
             color = Death_cause)) +
  geom_line(aes(y = gdppc*500)) +
  facet_wrap(~Country, nrow = 2, scales = "free_y")


Percentage_trend
Absolute_trend
```



