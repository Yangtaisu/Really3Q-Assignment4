---
title: "The Causes of Death in the World"
author:
- familyname: Shi
  othernames: Jingyi
  address: Monash University
  email: jshi0067@student.monash.edu
  correspondingauthor: true
  qualifications:  32267886
- familyname: Sun
  othernames: Miao
  address: Monash University
  email: msun0008@student.monash.edu
  correspondingauthor: true
  qualifications: 28380584
- familyname: Ou
  othernames: Jingwen
  address: Monash University
  email: jouu0006@student.monash.edu
  correspondingauthor: true
  qualifications:  32269633
- familyname: Qin
  othernames: Yu
  address: Monash University
  email: yqin0016@student.monash.edu
  correspondingauthor: true
  qualifications:  32606745
department: Faculty of Business and Statistic
organization: Monash University ETC5513 Group Really3Q
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    citation_package: biblatex
    toc: false
---

```{r,echo = FALSE,message=FALSE,warning=FALSE}
library(tidyverse)
library(ggplot2)
library(readr)
library(knitr)
```

```{r read_data, results='hide',echo = FALSE,message=FALSE,warning=FALSE}
annual_number_of_deaths_by_cause <- read_csv("Data/annual-number-of-deaths-by-cause.csv", 
    col_types = cols(`Number of executions` = col_double()))
life_expectancy <- read_csv("Data/life-expectancy.csv")
share_with_depression <- read_csv("Data/share-with-depression.csv")
```

\clearpage

## Introduction

Do you know around 56 million people die each year? What caused their death? How did the causes of death change over time and difference between countries and world regions? And can we prevent death early. There are the big questions we are answering in our presentation. Our data is from "data in our world"', It counts more than 20 causes of death in countries around the world from 1990 to 2018. For this table\@ref(tab:deathcauses), here is a list of the causes of death covered by this report. From this plot\@ref(fig:worldplot), we can see Cardiovascular diseases are the leading cause of death globally. The second biggest cause is Neoplasms. What about the specific situation in the different countries? The four members of our group will choose two countries of interest and make an analysis.

```{r deathcauses,echo = FALSE,message=FALSE,warning=FALSE}
world_data <-annual_number_of_deaths_by_cause %>% 
  filter(!is.na(Code),
         Year %in% c(1990:2018)) %>%
  pivot_longer(cols =  -c(1:3), 
               names_to = "Death_cause", 
               values_to = "Count") %>% 
  group_by(Year,Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))

world_data %>% filter(Year==1990) %>% 
  pull(Death_cause) %>% 
  kable(caption = "The caueses of death")

```

```{r worldplot,fig.cap ="Number of deaths by cause, World, 1990 to 2019",echo = FALSE,message=FALSE,warning=FALSE}
ggplot(world_data,
       mapping = aes(x=Year,
                     y=Death_amount,
                     color=Death_cause))+
  geom_line()+
  theme_bw()
```

\clearpage

## Main body

### Australia and Switzerland

**Q1: What can be observed in the chart of causes of death due to disease?**

**Q2: What can be observed in the chart of causes of death due to others?**

**(1).Plot death due to disease factors**

```{r,echo = FALSE,message=FALSE,warning=FALSE}
disease_data <- annual_number_of_deaths_by_cause %>% 
  select(1,3,5,6,7,8,9,12,13,14,15,16,17,18,22,24,26,27,32,33,34,36) %>% 
  filter(Country %in% c("Australia","Switzerland"),
         Year %in% c(1990:2018)) %>% 
  pivot_longer(cols =  -c(1:3), 
               names_to = "Death_cause", 
               values_to = "Count")
```

```{r diseaseplot,fig.cap="Number of deaths by disease causes, 1990 to 2018",echo = FALSE,message=FALSE,warning=FALSE}
AZ_life_expectancy <- life_expectancy %>% filter(
  Entity %in% c("Australia","Switzerland"),
  Year %in% c(1990:2018)
) %>% 
  rename("Country" = "Entity",
         "Life_expectancy" = "Life expectancy") %>% 
  select(-Code)

DL_data <- disease_data %>% 
  left_join(AZ_life_expectancy,by=c("Country","Year"))

ggplot(DL_data,
       mapping = aes(x=Year,
                     y=Count,
                     color=Death_cause))+
  geom_line()+
    facet_wrap(~Country,
             scales = "free_y")+
  theme_bw()
```

As we can see from this graph\@ref(fig:diseaseplot), cardiovascular disease and Neoplasm are the leading causes of death in both Australia and Switzerland, with cardiovascular disease decreasing but starting to rise again after about 2011, and the number of deaths from Alzheimer's and neoplasm rising sharply.

This result confused me. I would have thought that because of the advancement of medicine, the causes of death from disease should gradually decrease.So I looked up these three conditions online, all of which are highly prevalent in older people, and then in this table \@ref(tab:lifeexpendcy), I listed life expectancy in Australia and Switzerland from 1990 to 2019.As can be seen from the table\@ref(tab:lifeexpendcy), life expectancy increases as the years go by, meaning that more people are living old enough so that the number of people who are sick increases.

```{r lifeexpendcy,echo = FALSE,message=FALSE,warning=FALSE}
AZ_life_expectancy <- life_expectancy %>% filter(
  Entity %in% c("Australia","Switzerland"),
  Year %in% c(1990:2018)
) %>% 
  rename("Country" = "Entity",
         "Life_expectancy" = "Life expectancy") %>% 
  select(-Code)

AZ_life_expectancy %>% 
  head() %>% 
  kable(caption = "Life Expectancy in Australia and Switzerland")
```

In plot\@ref(fig:diseaseplot1), I have added this life expectancy line to the first graph for better visualisation and you can see that it is all on an up trend.

```{r diseaseplot1,fig.cap ="Add the line of life expectancy to fig1.",echo = FALSE,message=FALSE,warning=FALSE}
DL_data <- disease_data %>% 
  left_join(AZ_life_expectancy,by=c("Country","Year"))

ggplot(DL_data,
       mapping = aes(x=Year,
                     y=Count,
                     color=Death_cause))+
  geom_line()+
  geom_line(aes(y=Life_expectancy*500),
            color="#1CDC4B",
            size=1)+
  geom_point(aes(y=Life_expectancy*500),
             color="#12F09E",
             size=1)+
    scale_y_continuous(name = "Number of deaths by disease causes",
    sec.axis = sec_axis(trans =~./500,
                        name = "Life expectancy"))+
    facet_wrap(~Country,
             scales = "free_y")+
  theme_bw()

```

**(2).Plot death due to other factors**

```{r otherplot, fig.cap ="Number of deaths by other causes in Australia and Switzerland.",echo = FALSE,message=FALSE,warning=FALSE}
other_data <- annual_number_of_deaths_by_cause %>% 
  select(1,3,4,10,11,19,20,21,23,25,28,29,30,31,35) %>% 
  filter(Country %in% c("Australia","Switzerland"),
         Year %in% c(1990:2018)) %>% 
  pivot_longer(cols =  -c(1:3), 
               names_to = "Death_cause", 
               values_to = "Count")


 ggplot(other_data,
       mapping = aes(x=Year,
                     y=Count,
                     color=Death_cause))+
  geom_line()+
    facet_wrap(~Country,
             scales = "free_y")+
  theme_bw()

```

For other causes. This graph \@ref(fig:otherplot)shows that self-harm, road injuries are the main causes of death from other causes. Road injuries have been decreasing and I think this is closely related to the improving traffic laws and the popularity of driving tests. I noticed that Australia had an unusual peak in 2009. I searched Google for three keywords: Australia Fire 2009 and I got the information that there was a very serious forest fire in Vic in 2009. @Bushfire said that the Black Saturday fires started on 7 February 2009. Approximately 400 fires were recorded across Victoria, affecting 78 communities. A total of 173 people died in the fires, and 2029 houses were lost. So in 2009 an unusually high number of people died in fires in Australia.

In order to read data used R package @readr, clean the data used R package @tidyverse, plotting picture used R package @ggplot2.
